# Cloud Configuration

## Sauce Labs

### Initial Setup

1. Create run-time flags with sensible defaults that can be overridden
2. Specify the browser and operating system you want through Desired Capabilitaies
4. Connect to Sauce Labs' end-point through the Desired Capabilities
4. Store the WebDriver instance returned for use in your tests

```javascript
// filename: lib/config.js
module.exports = {
  host: process.env.HOST || 'saucelabs',
  sauce: {
    username: process.env.SAUCE_USERNAME,
    accessKey: process.env.SAUCE_ACCESS_KEY,
    platform: process.env.PLATFORM || 'Windows 7',
    browserName: process.env.BROWSER || 'internet explorer',
    version: process.env.BROWSER_VERSION || '11.0',
  },
};
```

```javascript
// filename: lib/DriverFactory.js
let builder = new Builder();
const url = 'http://ondemand.saucelabs.com:80/wd/hub';
builder.usingServer(url);
builder.withCapabilities(this.config.sauce);
const driver = builder.build();
```

For more info:

+ [Sauce Labs Available Platforms page](https://saucelabs.com/platforms)
+ [Sauce Labs Automated Test Configurator](https://docs.saucelabs.com/reference/platforms-configurator/#/)

### Setting the Test Name

1. Grab the test class and test method name dynamically after the test runs (in the `afterEach`)
2. Update the Sauce Labs job through Selenium's JavaScript executor

```javascript
const testName = this.currentTest.fullTitle();
driver.executeScript('sauce:job-name=' + testName);
```

### Setting the Job Status

1. Grab the test result dynamically after the test runs (in the `afterEach`)
2. Update the Sauce Labs job through Selenium's JavaScript executor

```javascript
const testResult = this.currentTest.state === 'passed'
driver.executeScript('sauce:job-result=' + testResult);
```
