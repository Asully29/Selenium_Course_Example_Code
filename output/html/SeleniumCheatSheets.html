<html>
  <head>
    <title>Selenium Cheat Sheets</title>
    <style type="text/css">
      @font-face {
        font-family: 'Droid Sans';
        font-style: normal;
        font-weight: 400;
        src: url('droid_sans.ttf');
        -fs-pdf-font-embed: embed;
        -fs-pdf-font-encoding: Identity-H;
      }
      body {
        font-family: 'Droid Sans';
      }
      div.page_footer {
      }
      h1 {
        page-break-before: always;
      }
      pre {
        white-space: pre;
        white-space: pre-wrap;
        page-break-inside: avoid;
        orphans: 0;
        widows: 0;
        background-color: #f5f5f5;
        border: 1px solid #ccc;
        border: 1px solid rgba(0, 0, 0, 0.15);
        border-radius: 4px;
        display: block;
        padding: 9.5px;
        margin: 0 0 10px;
        font-size: 13px;
        line-height: 20px;
      }
      code {
          padding: 2px 4px;
          background-color: #f7f7f9;
      }
      img {
        width: 600px;
      }
      .hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #888888 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0044DD } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
  </head>
  <body>
    <p align="center">
  <img src="cover.png" alt="Cheat Sheets Cover Image" style="width: 500px"/>
</p>
<h1>Table of Contents</h1><ol>
<li><a href="#chapter1">Local Configuration</a></li>
<li><a href="#chapter2">Cloud Configuration</a></li>
<li><a href="#chapter3">Common Actions</a></li>
<li><a href="#chapter4">Locators</a></li>
<li><a href="#chapter5">Cookies</a></li>
<li><a href="#chapter6">Dropdown Lists</a></li>
<li><a href="#chapter7">Exception Handling</a></li>
<li><a href="#chapter8">File Transfers</a></li>
<li><a href="#chapter9">Frames</a></li>
<li><a href="#chapter10">JavaScript</a></li>
<li><a href="#chapter11">Key Presses</a></li>
<li><a href="#chapter12">Multiple Windows</a></li>
<li><a href="#chapter13">Screenshots</a></li>
<li><a href="#chapter14">Waiting</a></li>
</ol>
<h1 id='chapter1'>Local Configuration</h1>
<h2>Chrome</h2>

<ol>
<li>Download the latest ChromeDriver binary from <a href="http://chromedriver.storage.googleapis.com/index.html">here</a></li>
<li>Add it to your path, or tell Selenium where to find it</li>
<li>Create an instance of Chrome</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Chrome</span><span class="o">::</span><span class="no">Service</span><span class="o">.</span><span class="n">executable_path</span> <span class="o">=</span> <span class="s1">'./chromedriver'</span>
<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:chrome</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://code.google.com/p/selenium/wiki/ChromeDriver">the Selenium wiki page for ChromeDriver</a></li>
<li><a href="https://sites.google.com/a/chromium.org/chromedriver/home">the official user documentation</a></li>
</ul>
<h2>Firefox</h2>

<p>Available out of the box.</p>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:firefox</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://sites.google.com/a/chromium.org/chromedriver/home">the Selenium wiki page for FirefoxDriver</a></li>
</ul>
<h2>Internet Explorer</h2>

<p>Only available on Microsoft Windows.</p>

<ol>
<li>Download the latest IEDriverServer from <a href="http://selenium-release.storage.googleapis.com/index.html">here</a></li>
<li>Add the downloaded file location to your <a href="http://www.computerhope.com/issues/ch000549.htm">path</a></li>
<li>Create an instance of Internet Explorer</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:internet_explorer</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://code.google.com/p/selenium/wiki/InternetExplorerDriver">the Selenium wiki page for InternetExplorerDriver</a></li>
</ul>
<h2>Opera</h2>

<p>Only works for version 12.16 or earlier. For newer versions of Opera, test using Chrome (since it uses the same back-end).</p>

<ol>
<li>Download the latest Selenium Standalone Server from <a href="http://selenium-release.storage.googleapis.com/index.html">here</a></li>
<li>Create an environment variable pointing to the server file</li>
<li>Create an instance of Opera</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="no">ENV</span><span class="o">[</span><span class="s1">'SELENIUM_SERVER_JAR'</span><span class="o">]</span> <span class="o">=</span> <span class="s1">'./selenium-server-standalone.jar'</span>
<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:opera</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://www.google.com'</span>
<span class="n">driver</span><span class="o">.</span><span class="n">quit</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://code.google.com/p/selenium/wiki/OperaDriver">The Selenium wiki page for OperaDriver</a></li>
</ul>
<h2>Safari</h2>

<p>Available out of the box as of version 2.21 of Selenium.</p>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:firefox</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://code.google.com/p/selenium/wiki/SafariDriver">the Selenium wiki page for SafariDriver</a></li>
</ul>
<h1 id='chapter2'>Cloud Configuration</h1>
<h2>Sauce Labs</h2>

<ol>
<li>Store your Sauce Labs Username and Access Key in environment variables</li>
<li>Specify the browser and operating system you want through Selenium's Capabilities</li>
<li>Create an instance of Selenium using the Sauce Labs end-point, passing in the Capabilities</li>
</ol>
<div class="highlight"><pre><span class="no">ENV</span><span class="o">[</span><span class="s1">'SAUCE_USERNAME'</span><span class="o">]</span> <span class="o">=</span> <span class="s1">'your username goes here'</span>
<span class="no">ENV</span><span class="o">[</span><span class="s1">'SAUCE_ACCESS_KEY'</span><span class="o">]</span> <span class="o">=</span> <span class="s1">'your access key goes here'</span>

<span class="n">capabilities</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Remote</span><span class="o">::</span><span class="no">Capabilities</span><span class="o">.</span><span class="n">firefox</span>
<span class="n">capabilities</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;23&quot;</span>
<span class="n">capabilities</span><span class="o">.</span><span class="n">platform</span> <span class="o">=</span> <span class="s2">&quot;Windows XP&quot;</span>
<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span><span class="p">(</span>
  <span class="ss">:remote</span><span class="p">,</span>
  <span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s2">&quot;http://SAUCE_USERNAME:SAUCE_ACCEESS_KEY@ondemand.saucelabs.com:80/wd/hub&quot;</span><span class="p">,</span>
  <span class="ss">:desired_capabilities</span> <span class="o">=&gt;</span> <span class="n">capabilities</span><span class="p">)</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://saucelabs.com/platforms">Sauce Labs Available Platforms page</a></li>
</ul>
<h1 id='chapter3'>Common Actions</h1>
<h2>Find an element</h2>
<div class="highlight"><pre><span class="c1"># just one, the first one</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

<span class="c1"># all instances of the element</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
<span class="c1"># returns an Array</span>
</pre></div><h2>Work with a found element</h2>
<div class="highlight"><pre><span class="c1"># Chain actions together</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>

<span class="c1"># Store the element</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
<span class="n">element</span><span class="o">.</span><span class="n">click</span>
</pre></div><h2>Work with a collection of found elements</h2>
<div class="highlight"><pre><span class="n">collection</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

<span class="c1"># by name</span>
<span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">click</span>
<span class="n">collection</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">click</span>

<span class="c1"># by index</span>
<span class="n">collection</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">click</span>
<span class="n">collection</span><span class="o">[-</span><span class="mi">1</span><span class="o">].</span><span class="n">click</span>
</pre></div><h2>Perform an action</h2>
<div class="highlight"><pre><span class="n">element</span><span class="o">.</span><span class="n">click</span>
<span class="n">element</span><span class="o">.</span><span class="n">submit</span>      <span class="c1"># submits a form</span>
<span class="n">element</span><span class="o">.</span><span class="n">clear</span>       <span class="c1"># clearing an input field of its text</span>
<span class="n">element</span><span class="o">.</span><span class="n">send_keys</span>   <span class="c1"># typing into an input field</span>
</pre></div><h2>Ask a question</h2>
<div class="highlight"><pre><span class="n">element</span><span class="o">.</span><span class="n">displayed?</span> <span class="c1"># is it visible?</span>
<span class="n">element</span><span class="o">.</span><span class="n">enabled?</span>   <span class="c1"># can it be selected?</span>
<span class="n">element</span><span class="o">.</span><span class="n">selected?</span>  <span class="c1"># is it selected?</span>
</pre></div><h2>Retrieve information</h2>
<div class="highlight"><pre><span class="c1"># by attribute name</span>
<span class="n">element</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span>

<span class="c1"># directly from an element</span>
<span class="n">element</span><span class="o">.</span><span class="n">text</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="http://selenium.googlecode.com/git/docs/api/rb/Selenium/WebDriver/Element.html#attribute-instance_method">the <code>attribute</code> documentation</a></li>
</ul>
<h1 id='chapter4'>Locators</h1>
<h1 id='chapter5'>Cookies</h1>
<h2>Retrieve Individual Cookie</h2>
<div class="highlight"><pre><span class="n">cookie</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">cookie_named</span> <span class="s1">'CookieName'</span>
</pre></div><h2>Add</h2>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">,</span> <span class="ss">value</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">)</span>
</pre></div><h2>Delete</h2>
<div class="highlight"><pre><span class="c1"># one cookie</span>
<span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">delete_cookie</span><span class="p">(</span><span class="s1">'CookieName'</span><span class="p">)</span>

<span class="c1"># all cookies</span>
<span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">delete_all_cookies</span>
<span class="c1"># does not delete third-party cookies, just the ones for the domain Selenium is visiting</span>
</pre></div><h1 id='chapter6'>Dropdown Lists</h1>

<ol>
<li>Find the dropdown list</li>
<li>Pass it into the Selenium Select helper function</li>
<li>Select from the list by its text or value</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://the-internet.herokuapp.com/dropdown'</span>
<span class="n">dropdown</span> <span class="o">=</span> <span class="vi">@driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s1">'dropdown'</span><span class="p">)</span>
<span class="n">select_list</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Support</span><span class="o">::</span><span class="no">Select</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">dropdown</span><span class="p">)</span>
<span class="n">select_list</span><span class="o">.</span><span class="n">select_by</span><span class="p">(</span><span class="ss">:text</span><span class="p">,</span> <span class="s2">&quot;Option 1&quot;</span><span class="p">)</span>
<span class="c1"># select_list.select_by(:value, &quot;1&quot;)</span>
</pre></div><h1 id='chapter7'>Exception Handling</h1>

<ol>
<li>Rescue the relevant exceptions in a helper method, returning <code>false</code> for each</li>
<li>Create a convenience method to see if an element is displayed</li>
</ol>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">rescue_exceptions</span>
  <span class="k">begin</span>
    <span class="k">yield</span>
  <span class="k">rescue</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Error</span><span class="o">::</span><span class="no">NoSuchElementError</span>
    <span class="kp">false</span>
  <span class="k">rescue</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Error</span><span class="o">::</span><span class="no">StaleElementReferenceError</span>
    <span class="kp">false</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">is_displayed?</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
  <span class="n">rescue_exceptions</span> <span class="p">{</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">displayed?</span> <span class="p">}</span>
<span class="k">end</span>

<span class="n">is_displayed?</span> <span class="n">locator</span>
<span class="c1"># will return false if the element is not displayed</span>
<span class="c1"># otherwise, it will return true</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://selenium.googlecode.com/git/docs/api/rb/Selenium/WebDriver/Error.html">a full list of Selenium exceptions</a></li>
</ul>
<h1 id='chapter8'>File Transfers</h1>
<h2>Upload</h2>

<ol>
<li>Find the text field for the upload form </li>
<li>Send text to it</li>
<li>Submit the form</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://the-internet.herokuapp.com/upload'</span>
<span class="n">uploader</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s1">'file-upload'</span><span class="p">)</span>
<span class="n">uploader</span><span class="o">.</span><span class="n">send_keys</span> <span class="s1">'path of file you want to upload'</span>
<span class="n">uploader</span><span class="o">.</span><span class="n">submit</span>
</pre></div><h2>Download</h2>

<ol>
<li>Get the download link from Selenium</li>
<li>Use a third-party HTTP library to perform a HEAD request</li>
<li>Query the headers to look at the content type and content length</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="nb">require</span> <span class="s1">'rspec-expectations'</span>
<span class="nb">require</span> <span class="s1">'rest-client'</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://the-internet.herokuapp.com/download'</span>
<span class="n">link</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="ss">css</span><span class="p">:</span> <span class="s1">'a'</span><span class="p">)</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="no">RestClient</span><span class="o">.</span><span class="n">head</span> <span class="n">link</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="ss">:content_type</span><span class="o">].</span><span class="n">should</span> <span class="o">==</span> <span class="s1">'image/jpeg'</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="ss">:content_length</span><span class="o">].</span><span class="n">to_i</span><span class="o">.</span><span class="n">should</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div><h2>Download Secure Files</h2>

<ol>
<li>Get the download link from Selenium</li>
<li>Pull the session cookie from Selenium</li>
<li>Use a third-party HTTP library to perform a HEAD request using the session cookie</li>
<li>Query the headers to look at the content type and content length</li>
</ol>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="nb">require</span> <span class="s1">'rspec-expectations'</span>
<span class="nb">require</span> <span class="s1">'rest-client'</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://admin:admin@the-internet.herokuapp.com/download_secure'</span>
<span class="n">link</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="ss">css</span><span class="p">:</span> <span class="s1">'a'</span><span class="p">)</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">cookie_named</span> <span class="s1">'rack.session'</span>
<span class="n">response</span> <span class="o">=</span> <span class="no">RestClient</span><span class="o">.</span><span class="n">head</span> <span class="n">link</span><span class="p">,</span> <span class="ss">cookie</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">cookie</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span><span class="si">}</span><span class="s2">=</span><span class="si">#{</span><span class="n">cookie</span><span class="o">[</span><span class="ss">:value</span><span class="o">]</span><span class="si">}</span><span class="s2">;&quot;</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="ss">:content_type</span><span class="o">].</span><span class="n">should</span> <span class="o">==</span> <span class="s1">'application/pdf'</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="ss">:content_length</span><span class="o">].</span><span class="n">to_i</span><span class="o">.</span><span class="n">should</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div><h1 id='chapter9'>Frames</h1>

<ol>
<li>Switch into the frame</li>
<li>Perform an action</li>
</ol>
<h2>Nested Frames</h2>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="nb">require</span> <span class="s1">'rspec-expectations'</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://the-internet.herokuapp.com/frames'</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s1">'frame-top'</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s1">'frame-middle'</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s1">'content'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">should</span> <span class="o">=~</span> <span class="sr">/MIDDLE/</span>
</pre></div><h2>IFrames</h2>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>
<span class="nb">require</span> <span class="s1">'rspec-expectations'</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span> <span class="s1">'http://the-internet.herokuapp.com/tinymce'</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s1">'mce_0_ifr'</span><span class="p">)</span>
  <span class="n">editor</span> <span class="o">=</span> <span class="vi">@driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s1">'tinymce'</span><span class="p">)</span>
  <span class="n">before_text</span> <span class="o">=</span> <span class="n">editor</span><span class="o">.</span><span class="n">text</span>
  <span class="n">editor</span><span class="o">.</span><span class="n">clear</span>
  <span class="n">editor</span><span class="o">.</span><span class="n">send_keys</span> <span class="s1">'Hello World!'</span>
  <span class="n">after_text</span> <span class="o">=</span> <span class="n">editor</span><span class="o">.</span><span class="n">text</span>
<span class="n">after_text</span><span class="o">.</span><span class="n">should_not</span> <span class="o">==</span> <span class="n">before_text</span>


<span class="c1"># Hovers</span>

<span class="mi">1</span><span class="o">.</span> <span class="no">Find</span> <span class="n">the</span> <span class="n">element</span>
<span class="mi">2</span><span class="o">.</span> <span class="no">Create</span> <span class="n">an</span> <span class="n">action</span> <span class="n">with</span> <span class="n">the</span> <span class="no">Selenium</span> <span class="no">Action</span> <span class="n">builder</span>
<span class="mi">3</span><span class="o">.</span> <span class="no">Pass</span> <span class="k">in</span> <span class="n">the</span> <span class="n">found</span> <span class="n">element</span> <span class="k">when</span> <span class="n">calling</span> <span class="n">the</span> <span class="sb">`move_to`</span> <span class="n">action</span>
<span class="mi">4</span><span class="o">.</span> <span class="no">Perform</span> <span class="n">the</span> <span class="n">action</span>

<span class="sb">```ruby</span>
<span class="sb">element = driver.find_element(locator)</span>
<span class="sb">driver.action.move_to(element).perform</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://selenium.googlecode.com/git/docs/api/rb/Selenium/WebDriver/ActionBuilder.html#move_to-instance_method">the Selenium Action Builder <code>move_to</code> documentation</a></li>
</ul>
<h1 id='chapter10'>JavaScript</h1>
<h2>Execution</h2>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">'your javascript goes here'</span><span class="p">)</span>
</pre></div><h2>Alerts</h2>
<div class="highlight"><pre><span class="n">popup</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span>
<span class="n">popup</span><span class="o">.</span><span class="n">accept</span>
<span class="c1"># or popup.dismiss</span>
</pre></div><h1 id='chapter11'>Key Presses</h1>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="c1"># e.g., driver.action.send_keys(:tab)</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="https://selenium.googlecode.com/git/docs/api/rb/Selenium/WebDriver/ActionBuilder.html#send_keys-instance_method">the Selenium Action Builder <code>send_keys</code> documentation</a></li>
<li><a href="http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Keys.html">a list of available keyboard keys and their trigger values</a></li>
</ul>
<h1 id='chapter12'>Multiple Windows</h1>
<h2>A simple way</h2>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">window_handles</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">window_handles</span><span class="o">.</span><span class="n">last</span><span class="p">)</span>
</pre></div>
<p>Caveat: The order of the window handles is not consistent across all browsers. Some return in the order opened, others alphabetically.</p>
<h2>A solid way</h2>
<div class="highlight"><pre><span class="n">main_window</span> <span class="o">=</span> <span class="vi">@driver</span><span class="o">.</span><span class="n">window_handle</span>
<span class="c1"># action that triggers a new window</span>
<span class="n">windows</span> <span class="o">=</span> <span class="vi">@driver</span><span class="o">.</span><span class="n">window_handles</span>
<span class="n">windows</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">window</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">main_window</span> <span class="o">!=</span> <span class="n">window</span>
    <span class="vi">@new_window</span> <span class="o">=</span> <span class="n">window</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div><h1 id='chapter13'>Screenshots</h1>
<h2>Simple screenshot</h2>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">save_screenshot</span> <span class="s2">&quot;screenshot.png&quot;</span>
</pre></div><h2>Uniquely named screenshot by timestamp</h2>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">save_screenshot</span> <span class="s2">&quot;./</span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;failshot__%d_%m_%Y__%H_%M_%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">.png&quot;</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="http://strfti.me/">strftime reference and sandbox</a></li>
</ul>
<h1 id='chapter14'>Waiting</h1>
<h2>Implicit Wait</h2>

<ul>
<li>Only needs to be configured once</li>
<li>Tells Selenium to wait for a specified amount of time before raising a <code>NoSuchElementError</code> exception</li>
<li>Can be overridden with an explicit wait</li>
</ul>
<div class="highlight"><pre><span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">timeouts</span><span class="o">.</span><span class="n">implicit_wait</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="http://elementalselenium.com/tips/47-waiting">Explicit vs Implicit Waits</a></li>
</ul>
<h2>Explicit Waits</h2>

<ul>
<li>Specify an amount of time and an action</li>
<li>Selenium will try the action repeatedly until either:

<ul>
<li>the action can be accomplished</li>
<li>the amount of time has been reached (and throw a timeout exception)</li>
</ul></li>
</ul>
<div class="highlight"><pre><span class="n">wait</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Wait</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">timeout</span><span class="p">:</span> <span class="n">seconds</span><span class="p">)</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span> <span class="p">{</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">displayed?</span> <span class="p">}</span>
</pre></div>
<p>For more info:</p>

<ul>
<li><a href="http://elementalselenium.com/tips/47-waiting">Explicit vs Implicit Waits</a></li>
</ul>

  </body>
</html>
