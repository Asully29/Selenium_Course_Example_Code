# Flexible Test Execution

In order to get the most out of our tests we'll want a way to break them up into relevant, targeted chunks. Running tests in smaller groupings like this (along with parallel execution) will help keep test run times to a minimum and help enhance the amount of feedback you get in a timely fashion.

With [Mocha's `--grep` feature](https://github.com/mochajs/mocha/wiki/Tagging) we're able to easily achieve test grouping (a.k.a. tags).

Let's step through how to set this up.

## Specifying Tags

Grep is a simple text match function. It will look through the test files and execute them if it found a match for a given string pattern. To make this work we'll want to add some metadata to our test names with with a special character to make it stand out as metadata so it's easier to search for.

Some simple examples of this are `@shallow` and `@deep`. `@shallow` tests are roughly equivalent to "smoke" or "sanity" tests. These should pass before you can consider running other tests which aren't as mission critical and may take longer to run (e.g., `@deep` tests).

Let's update our tests to apply these "tags".

```javascript
// filename: test/LoginTest.js
// ...
  it('with valid credentials @shallow', async function() {
// ...
  it('with invalid credentials @deep', async function() {
// ...
```

In `LoginTest.js` we updated the test names directly. The happy path test is now marked as `@shallow` and the invalid credentials test as `@deep`. Now let's apply the `@deep` marker to the entire class in `DynamicLoadingTest.js`.

```javascript
// filename: test/DynamicLoadingTest.js
// ...
describe('Dynamic Loading @deep', function() {
// ...
```

Tags are powerful since they can be applied across different test files, enabling you to create a dynamic grouping of tests at runtime.

## Running Tags

With both Mocha and mocha-parallel-tests we can specify which marker to launch at runtime. This is handled as another runtime flag on the command-line using `--grep`.

```sh
mocha --grep @shallow
mocha-parallel-tests --grep @shallow
```


