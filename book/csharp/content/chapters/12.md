# Running A Different Browser Locally

It's straightforward to get your tests running locally against Firefox (that's what we've been doing up until now). But when you want to run them against a different browser like Chrome, Safari, or Internet Explorer you quickly run into configuration overhead that can seem overly complex and lacking in good documentation or examples.

## A Brief Primer On Browser Drivers

With the introduction of WebDriver (circa Selenium 2) a lot of benefits were realized (e.g., more effective and faster browser execution, no more single host origin issues, etc). But with it came some architectural and configuration differences that may not be widely known. Namely -- browser drivers.

WebDriver works with each of the major browsers through a browser driver which is (ideally but not always) maintained by the browser manufacturer. It is an executable file (consider it a thin layer or a shim) that acts as a bridge between Selenium and the browser.

Let's step through an example using [ChromeDriver](https://sites.google.com/a/chromium.org/chromedriver/).

## An Example

Before starting, we'll need to download the latest ChromeDriver binary executable for our operating system from [here](http://chromedriver.storage.googleapis.com/index.html) (pick the highest numbered directory) an unzip its contents into the `Vendor` directory.

```text
├── PageObjects
│   ├── BasePage.cs
│   ├── DynamicLoadingPage.cs
│   └── LoginPage.cs
├── Tests
│   ├── BaseTest.cs
│   ├── DynamicLoadingTest.cs
│   └── LoginTest.cs
└── Vendor
    ├── chromedriver
    └── geckodriver
```

In order for Selenium to use this binary we have to make sure it knows where it is. There are two ways to do that. We can add `chromedriver` to the path of our system, or use the same approach we did for Firefox (specifying the path to the vendor directory through a service object). Let's go with the latter option.

We'll also want to make sure our test suite can run either Firefox or Chrome. To do that, we'll need to make a couple of changes.

First, let's add support for a `BROWSER_NAME` environment variable.

```csharp
// filename: Tests/BaseTest.cs
// ...
    class BaseTest
    {
        // ...
        private static string BrowserName;

        [SetUp]
        protected void SetUp()
        {
            BaseUrl       = System.Environment.GetEnvironmentVariable("BASE_URL") ?? "http://the-internet.herokuapp.com";
            BrowserName   = System.Environment.GetEnvironmentVariable("BROWSER_NAME") ?? "firefox";
            // ...
```

After creating field variables for both the browser name and the vendor directory we update the `LoadConfigValues` private method to populate them. Fetching the `BrowserName` is straightforward. We're doing the same thing that we did for `ApplicationBaseUrl` and just providing the new key. For the vendor directory we're looking up the full path to the root of the test directory (by way of looking up the assembly location for the base test and its parent directory) and appending `\Vendor` with a string literal (e.g., `@`). This gives us the full path to the `Vendor` directory.

Now to modify the browser setup.

```csharp
// filename: Tests/BaseTest.cs
using OpenQA.Selenium.Chrome;
// ...
        [SetUp]
        protected void SetUp()
        {
            // ...
            switch (BrowserName.ToLower())
            {
                case "firefox":
                {
                    var Service = FirefoxDriverService.CreateDefaultService(VendorDirectory);
                    Driver = new FirefoxDriver(Service);
                    break;
                }
                case "chrome":
                {
                    var Service = ChromeDriverService.CreateDefaultService(VendorDirectory);
                    Driver = new ChromeDriver(Service);
                    break;
                }
            }
        }
// ...
```

In `SetUp` we're performing a conditional check against the `BrowserName` field variable (after we set it to lower-case letters for consistency). When the value is set to `"firefox"` we run the tests just like before. When set to `"chrome"` we create a Chrome service object, give it the path to the vendor directory, and create a new instance of ChromeDriver.

Now we can run our tests on a different browser by specifying its name at run-time (e.g., `BROWSER_NAME="chrome" dotnet test`).

## Additional Browsers

A similar approach can be applied to other browser drivers, with the only real limitation being the operating system you're running. But remember -- __no two browser drivers are alike__. Be sure to check out the documentation for the browser you care about to find out the specific requirements:

+ [ChromeDriver](https://github.com/seleniumhq/selenium/wiki/ChromeDriver)
+ [EdgeDriver](https://developer.microsoft.com/en-us/microsoft-edge/platform/documentation/dev-guide/tools/webdriver/)
+ [FirefoxDriver](https://github.com/seleniumhq/selenium/wiki/FirefoxDriver)
+ [InternetExplorer Driver](https://github.com/seleniumhq/selenium/wiki/InternetExplorerDriver)
+ [SafariDriver (old)](https://github.com/seleniumhq/selenium/wiki/SafariDriver)
+ [SafariDriver (new)](https://webkit.org/blog/6900/webdriver-support-in-safari-10/)


