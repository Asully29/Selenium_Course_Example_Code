# Basic Auth

On some occasions you may work with apps that are secured with [Basic HTTP Authentication](http://en.wikipedia.org/wiki/Basic_access_authentication). And in order to access them you will need to pass credentials to the server when requesting a page.

Before Selenium 2 we were able to accomplish this by injecting credentials into a custom header, but now the cool kid way is to use something like [BrowserMob Proxy](http://bmp.lightbody.net/). And some people are solving this with browser specific configurations.

But all of this feels heavy. Instead, let's look at a simple approach that is browser agnostic.

## An Example

We can simply pass in the username and password in the URL that we are requesting (for both HTTP or HTTPS). Let's take a look at an example.

```ruby
require 'selenium-webdriver'
require 'rspec-expectations'

def setup
  @driver = Selenium::WebDriver.for :firefox
end

def teardown
  @driver.quit
end

def run
  setup
  yield
  teardown
end
```

We start off by requiring our libraries and implementing setup, teardown, and run actions.

```ruby
run do
  @driver.get 'http://admin:admin@the-internet.herokuapp.com/basic_auth'
  page_message = @driver.find_element(css: 'p').text
  page_message.should =~ /Congratulations!/
end
```

In the run action we are getting the page by passing in the username and password in the URL. Once it loads we grab text from the page, and make an assertion against it.

Alternatively, we could have accessed the page with credentials as part of the setup action and then accessed the page again (or any other HTTP page behind basic auth) **without** credentials.

Here's what that would look like.

```ruby
require 'selenium-webdriver'
require 'rspec-expectations'

def setup
  @driver = Selenium::WebDriver.for :firefox
  @driver.get 'http://admin:admin@the-internet.herokuapp.com/basic_auth'
end

def teardown
  @driver.quit
end

def run
  setup
  yield
  teardown
end

run do
  @driver.get 'http://the-internet.herokuapp.com/basic_auth'
  page_message = @driver.find_element(css: 'p').text
  page_message.should =~ /Congratulations!/
end
```

NOTE: If your application serves both HTTP and HTTPS pages from behind basic auth then you will need to load one of each type before executing your test steps. Otherwise you will get authorization errors when switching between HTTP and HTTPS. This happens because the browser can't use basic auth credentials interchangeably (e.g., HTTP for HTTPS and vice versa).

## Expected Behavior

+ Load the HTTP and/or HTTPS page caching basic auth credentials
+ Load the page
+ Get the page text
+ Assert that it contains what it should
