# File Upload

Normally when interacting with forms to upload a file you're prompted with a dialog box that is just out of reach for Selenium.

In these cases, people tend to turn to a tool to drive the GUI, such as Auto-IT. While this helps solve short-term pain, it sets you up for long term hurt later by chaining you to a specific platform -- limiting your ability to effectively test different browser/OS combinations.

A work-around for this problem is to side-step the dialog box experience entirely, and rather, inject the path of the file you want to upload into the form element, and then submit the form.

Let's break down this approach with some example Ruby code using Selenium WebDriver Remote and an example file upload form.

## An Example

You can see the application we are running against [here](http://the-internet.herokuapp.com/upload).

For our test script, first we'll include the requisite libraries and wire-up our setup and teardown actions in helper methods.

```ruby
require 'selenium-webdriver'
require 'rspec-expectations'

def setup
  @driver = Selenium::WebDriver.for :firefox
end

def teardown
  @driver.quit
end
```

We are using the selenium-webdriver gem to drive the browser, and rspec-expectations for our assertion action (which is a subset of the RSpec library).

```ruby
def run
  setup
  yield
  teardown
end

run do
  @driver.get 'http://the-internet.herokuapp.com/upload'
  uploader = @driver.find_element(id: 'file-upload')
  uploader.send_keys Dir.pwd + '/DaveHaeffner.jpg'
  uploader.submit

  uploaded_image = @driver.find_element(css: '.example img').attribute('src')
  uploaded_image.should =~ /DaveHaeffner.jpg/
end
```

We created a helper method called 'run' to easily call our setup and teardown actions without being overly verbose.

In our run block we are driving the test script using standard Selenium commands and ending things off with an RSpec assertion.

## Expected Behavior

So the intended behavior is:

+ Load the page
+ Grab the form element we want to work with
+ Inject the path to the file we want to upload
+ Submit the form
+ Grab the source path for the image once it renders in the browser
+ Check to see that the image path contains the proper filename
